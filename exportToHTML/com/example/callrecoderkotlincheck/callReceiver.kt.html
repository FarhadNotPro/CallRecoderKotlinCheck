<html>
<head>
<title>callReceiver.kt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #0033b3;}
.s1 { color: #080808;}
.s2 { color: #067d17;}
.s3 { color: #8c8c8c; font-style: italic;}
.s4 { color: #1750eb;}
</style>
</head>
<body bgcolor="#ffffff">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#c0c0c0" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
callReceiver.kt</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">com.example.callrecoderkotlincheck</span>

<span class="s1">import android.content.BroadcastReceiver</span>
<span class="s1">import android.content.Context</span>
<span class="s1">import android.content.Intent</span>
<span class="s1">import android.telephony.TelephonyManager</span>
<span class="s1">import android.view.Gravity</span>
<span class="s1">import android.widget.Toast</span>
<span class="s1">import androidx.core.content.ContextCompat</span>

<span class="s0">class </span><span class="s1">callReceiver : BroadcastReceiver() {</span>

    <span class="s1">override </span><span class="s0">fun </span><span class="s1">onReceive(context: Context, intent: Intent) {</span>
        <span class="s0">if </span><span class="s1">(intent.getStringExtra(TelephonyManager.EXTRA_STATE) == TelephonyManager.EXTRA_STATE_OFFHOOK) {</span>
            <span class="s1">showToast(context, </span><span class="s2">&quot;Call Started...&quot;</span><span class="s1">)</span>
            <span class="s0">val </span><span class="s1">input = </span><span class="s2">&quot;This is Service Started from BCReceiver&quot;</span>
            <span class="s0">val </span><span class="s1">serviceIntent = Intent(context, ExampleService::</span><span class="s0">class</span><span class="s1">.java)</span>
            <span class="s1">serviceIntent.putExtra(</span><span class="s2">&quot;inputExtra&quot;</span><span class="s1">, input)</span>
            <span class="s1">ContextCompat.startForegroundService(context, serviceIntent)</span>

            <span class="s3">/*         Intent myStarterIntent = new Intent(context, MainActivity.class); 
            myStarterIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
            context.startActivity(myStarterIntent);*/</span>
        <span class="s1">} </span><span class="s0">else if </span><span class="s1">(intent.getStringExtra(TelephonyManager.EXTRA_STATE) == TelephonyManager.EXTRA_STATE_IDLE) {</span>
            <span class="s1">showToast(context, </span><span class="s2">&quot;Call Ended...&quot;</span><span class="s1">)</span>
            <span class="s0">val </span><span class="s1">serviceIntent = Intent(context, ExampleService::</span><span class="s0">class</span><span class="s1">.java)</span>
            <span class="s3">//.stopService(serviceIntent)</span>
        <span class="s1">}</span>
    <span class="s1">}</span>

    <span class="s0">fun </span><span class="s1">showToast(context: Context?, message: String?) {</span>
        <span class="s0">val </span><span class="s1">toast = Toast.makeText(context, message, Toast.LENGTH_LONG)</span>
        <span class="s1">toast.setGravity(Gravity.CENTER, </span><span class="s4">0</span><span class="s1">, </span><span class="s4">0</span><span class="s1">)</span>
        <span class="s1">toast.show()</span>
    <span class="s1">}</span>
<span class="s1">}</span>
</pre>
</body>
</html>